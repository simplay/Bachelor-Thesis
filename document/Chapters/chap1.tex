\section{Introduction}

structural coloration is production of color through the interactio of light with nanoscale surface strucrure. Color production is die to wave interference with quasiperiodic structures whose periodicity leads to interaction with visible light.

the interfenrence itself may be  caused by a variety of photonic mechanisms such as diffraction gratings, 2d and 3dd photonic cristals or crystal fibres.


Robert Hooke = observed connection between microscopic structures and colorisation
wave nature of light led to conclusion that the cause for the coloration lies in wave interference.

derive refllectance models suitable for interactive rendering directly from physical measurements of biological structures, focused on structural colors generated by diffraction gratings. in particular our apporach applies to sufaces with quasiperiodic structures at nanometer scale that can be represented as heighfields of different snakes sheds using AFM.

goal: interactive rendering of diffraction effects from complex physical nanostructures acquired using electron or atomic force microscopy (AFM). We obtained snake skin surface gratings geometry using afm, which delivers height field data representing surface structures at the nanometer scale. such height fields are denoted as h(x,y).

the nanostructures we are interested in exhibits periodicity on the scale of wavelength of visible light. Hence rendering requires taking into account the wave nature of light to reproduce these effects.

=> stam paper:
under certain conditions formulate conventional BRDFs for such nanostructures. assumes surface is observed from a large enough distance and then uses the kirchoff integral 


$WIKI: http://en.wikipedia.org/wiki/Electromagnetic_radiation$

Electromagnetic radiation (EM radiation or EMR) is one of the fundamental phenomena of electromagnetism, behaving as waves propagating through space, and also as photon particles traveling through space, carrying radiant energy.

EMR is characterized by the frequency or wavelength of its wave. The electromagnetic spectrum, in order of increasing frequency and decreasing wavelength, consists of radio waves, microwaves, infrared radiation, visible light, ultraviolet radiation, X-rays and gamma rays. 

The eyes of various organisms sense a somewhat variable but relatively small range of frequencies of EMR called the visible spectrum or light. Higher frequencies correspond to proportionately more energy carried by each photon; for instance, a single gamma ray photon carries far more energy than a single photon of visible light.

EMR carries energy—sometimes called radiant energy—through space continuously away from the source

In general, EM radiation (the designation $'radiation'$ excludes static electric and magnetic and near fields) is classified by wavelength into radio, microwave, infrared, the visible spectrum we perceive as visible light, ultraviolet, X-rays, and gamma rays. Arbitrary electromagnetic waves can always be expressed by Fourier analysis in terms of sinusoidal monochromatic waves, which in turn can each be classified into these regions of the EMR spectrum.

The behavior of EM radiation depends on its frequency. Lower frequencies have longer wavelengths, and higher frequencies have shorter wavelengths, and are associated with photons of higher energy. There is no fundamental limit known to these wavelengths or energies, at either end of the spectrum, although photons with energies near the Planck energy or exceeding it (far too high to have ever been observed) will require new physical theories to describe.

$WIKI: http://en.wikipedia.org/wiki/Radiant_energy$
Radiant energy is the energy of electromagnetic waves.[1] The quantity of radiant energy may be calculated by integrating radiant flux (or power) with respect to time and, like all forms of energy, its SI unit is the joule. The term is used particularly when radiation is emitted by a source into the surrounding environment. Radiant energy may be visible or invisible to the human eye.

The term $"radiant energy"$ is most commonly used in the fields of radiometry, solar energy, heating and lighting,


$WIKI: http://en.wikipedia.org/wiki/Radiance$
Radiance and spectral radiance are measures of the quantity of radiation that passes through or is emitted from a surface and falls within a given solid angle in a specified direction. They are used in radiometry to characterize diffuse emission and reflection of electromagnetic radiation. In astrophysics, radiance is also used to quantify emission of neutrinos and other particles. The SI unit of radiance is watts per steradian per square metre (W·sr−1·m−2), while that of spectral radiance is W·sr−1·m−2·Hz−1 or W·sr−1·m−3 depending on whether the spectrum is a function of frequency or of wavelength.

Radiance characterizes total emission or reflection. Radiance is useful because it indicates how much of the power emitted by an emitting or reflecting surface will be received by an optical system looking at the surface from some angle of view. In this case, the solid angle of interest is the solid angle subtended by the optical system's entrance pupil. Since the eye is an optical system, radiance and its cousin luminance are good indicators of how bright an object will appear. For this reason, radiance and luminance are both sometimes called $"brightness"$. This usage is now discouraged – see Brightness for a discussion. The nonstandard usage of $"brightness"$ for $"radiance"$ persists in some fields, notably laser physics

Def $L = \frac{d^2 \Phi}{dA d\Omega cos(\theta)} \approx \frac{\Phi}{\Omega A cos(\theta)}$


\subsection{Motivation}
effect of diffraction, stam, genf, rendering snake skin 

Introducation
bla 
In phicss/bioligy

The purpose of this thesis is to render realtime the effect of diffraction on different snakes skins in a photorealistic manor. In oder to achieve this purpose we will rely J. Stam's formulation of a BRDF which basically describes the effect of diffraction on a given surface assuming one knows the hightfield on this surface.
In our case, those heightfields are small patches of the nanostracture of the snake skin provided by GENEVA taken by MIKROSKOP.
In his Paper, J. Stam assuming distribution on his heightfields whereas we require a an explicit provided hightfield of the surface or at least a small patch. Therefore, this work can be considered as an extension of J. Stam's derivations for the case one is provided by a explicit height field on a quasiperiodic structure.
Since one goal of this work is to render in realtime, we have to perform also precomputations which will require us to slightly modify Stam's main derivation.


Explain that this thesis has deep theoretical background, some derivations
show derivation roadmap


\subsection{Stams derivation}

In his Paper Diffraction Shader, Jos Stam derives a BRDF which modeling the effect of diffraction for various analytical anistropic reflaction models using the scalar Kirchof theory and the theory of random processes. By emplyong the so called wave theory of diffraction [source 5 in stams paper] in which a wave is assumed to be a complex valued scalar. It's noteworthy, that stam's BRDF formulation does not take into account the polarization of the light. Nevertheless, light sources like sunlight and light bulbs are unpilarizaed. In our simulations we will always assume we have given i directional light source, i.e. sunlight. Hence, we can use stam's model for our derivations

A further assumption in Stam's Paper is, the emanated waves from the source are stationary - sunlight once again.
Which implies the wave is a superposition of independent monochromatic waves. This implies that each wave is associated to a definite wavelangth lambda.

Mention Helmolth equation, which has the solution $k = \frac{2\pi}{\lambda}$ which is the wavenumber

Stams starts his derviations by above's assumptions and by applying the Kirchhoff integral, which descirbes the reflected field and the Huygen's principle, which states, when somebody knows the wavefront at a given moment, the wave at a later time can be deducted by considering each point on the first wave as the source of a new disturbance.

\begin{equation}
  \psi_2 = \frac{i k e^{i K R}}{4 \pi R}(F\mathbf{v}-\mathbf{p}) \cdot \int_{S} \hat{\mathbf{n}} e^{ik\mathbf{v} \cdot \mathbf{s} d\mathbf{s}}
\end{equation}


In optics, when dealing with scattered waves, one does use differential scattering cross-section rather than a BRDF which has the following identitiy: 

\begin{equation}
    \sigma^0 = 4 \pi \lim_{R \to \infty} R^2 \frac{\langle \left|\psi_2\right|^2\rangle}{\langle \left|\psi_1\right|^2\rangle}
\end{equation}

Relationship between the BRDF and the scattering cross section is the follwing:

\begin{equation}
    BRDF = \frac{1}{4\pi}\frac{1}{A}\frac{\sigma^0}{cos(\theta_1)cos(\theta_2)}
\end{equation}

Wheras $\theta_1a$ and $\theta_2$ are the angles that the vectors $\hat{k_1}$
and $\hat{k_2}$ make with the vertical direction.
 
ADD FIGURE for k1, k2

where R is the disance from the center of the patch to the receiving point $x_p$, $\hat{\mathbf{n}}$ is the normal of the surface at s and the vectors:

\begin{equation*}
    \mathbf{v} = \hat{\mathbf{k_1}} - \hat{\mathbf{k_1}}
               = (u,v,w)
\end{equation*}

\begin{equation*}
    \mathbf{p} = \hat{\mathbf{k_1}} + \hat{\mathbf{k_1}}
\end{equation*}

During his derivations, Stam provides a analytical representation for the Kirchhoff integral by using his assumptions. He restricts himself to the reflaction of waves from height fields $h(x,y)$ with the assumption that the surface is defined as an elevation over the (x,y) plane using the surface plane approximation.
Which will lead him to the follwoing identity for the Kirchhoff integral

\begin{equation}
    \mathbf{I}(ku, kv) = \int \int \frac{1}{ikw}(-p_x, -p_y, ikwp) 
\end{equation}

wheras 

\begin{equation}
    p(x,y) = e^{ikwh(x,y)}
\end{equation}

We the observation that the integral is a Fourier transform by $-iku$ and $-ikv$
which will lead us to his final derivation, using the identity of BRDF, and computing the limes:

\begin{equation}
    BRDF = \frac{k^2 F^2 G}{4\pi^2 A w^2} \langle \left|P(ku, kv)\right|^2\rangle
\end{equation}

Where 

\begin{equation}
    G = \frac{(1-\hat{\mathbf{k_1}}\cdot\hat{\mathbf{k_2}})^2}{cos(\theta_1)cos(\theta_2)}
\end{equation}

and P(x,y) is the Fourier transform of the function p(x,y) from above.

This identitiy for the BRDF is the starting point for our derivations.



\subsection{Related Work}
see papaer listing
\subsection{Thesis Outline}
describe what is which chapter

