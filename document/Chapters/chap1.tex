\section{Introduction}


rendering diffraction colors caused by coherent (as opposed to statistical) surface micro-geometry.
tables containing the result of the spectral integration predicted by the model of Stam. 
The theory is applied to render diffraction caused by acquired geometric models of the microstructure of snake skin, so as to reproduce the irridescent effects displayed by these animals.


\subsection{Motivation}
In Nature, coloring mostly comes from the inherent colors of materials but sometimes colorization has a pure physical origin such as the effect diffraction or interference of light. Both phenomenon are causing the so called structural coloration, which is the production of color through the interaction of visible light with micrioscopically structured surfaces. 
Color production is die to wave interference with quasiperiodic structures whose periodicity leads to interaction with visible light. Therefore we perceive color when the different wavelengths composing white light are selectively interfered with by matter (absorbed, reflected, refracted, scattered, or diffracted) on their way to our eyes, or when a non-white distribution of light has been emitted.
In animals, such as feathers of birds and the scales of butterflies, interference is created by a range of photonic mechanisms, including diffraction grating, selective mirrors, photonic crystals.
The connection beween microscopic structures and coloration has been observed by Robert Hooke in the early seventeenth centrury. The discovery of the wave nature of light led to the conclusion that the cause for the coloration lies in wave interference.

In the field of computer graphics, many researchers have been attempted rendering of structural colors but most of the techniques so far, however, are either too slow for interactive rendering or rely on simplofying assumption, like modeling light as rays, to achieve real-time performance. 

\subsection{Goals}
The purpose of this thesis is to render realtime structural colors caused by the effect of diffraction on differentr biological structures. We focus on structural colors generated by diffraction grating, in particular our approach applies to surfaces with quasiperiodic structures at the nanometer scale that can be represented as heighfields. such structures are found on the sehds of snkaes, wings of butterflies or the bodies of various insects. we focus on sknake skins and we acquirednanoscale heightfields of different snake sheds using atomic force microscopy. 

In oder to achieve this rendering purpose we will rely J. Stam's formulation of a BRDF which basically describes the effect of diffraction on a given surface assuming one knows the hightfield on this surface and will further extend it. 
In our case, those heightfields are small patches of the microstructured surface (in nano-scale) of AFM taken snake skin patches provided by GENEVA.

In his Paper, J. Stam assuming distribution on his heightfields whereas we require a an explicit provided hightfield of the surface or at least a small patch. Therefore, this work can be considered as an extension of J. Stam's derivations for the case one is provided by a explicit height field on a quasiperiodic structure.
Since one goal of this work is to render in realtime, we have to perform also precomputations which will require us to slightly modify Stam's main derivation.


\subsection{Key Concepts}

Diffraction occurs when the surface detail is comparable to the wave- length of light
Fourier analysis has enabled us to tackle the difficult task of computing the reflected waves off of these surfaces

Diffraction is a purely wave-like phenomenon which cannot be modeled using the standard ray the- ory of light.
Diffraction should not be confused with the related phenomenon of interference
Interesting diffraction phenomena, however, occur mostly when the surface detail is highly anisotropic, viz. non-isotropic
Interference produces colorful effects due to the phase differences caused by a wave traversing thin media of different indices of refraction
Interference,unlike diffraction, can be modeled using the ray theory of light alone

well known from physical optics that ray theory is only an approximation of the more fundamental wave theory
+ ray theory is sufficient to visually capture the reflected field from many commonly occurring surfaces
+ common belief that models based on wave theory are computationally too expensive to be of any use in computer graphics

derive analytical reflection models based on wave theory that capture the effects of diffraction


\subsubsection{Diffraction}
\subsubsection{Basis: J. Stam}
--------
stam employee scalar wave theory of diffraction - approximation the light wave is assumed to be a complex valued scalar disturbance $\Phi$
Theory completely ignores the polarization of light, so its results are therefore restricted to unpolarized light but common light sources such as the sun and light bulbs are totally unpolarized

also assume that the waves emanating from the source are stationary. means that the wave is a superposition of independent monochromatic waves and consequently we can restrict our analysis to a wave having a definite wavelength lambda associated with i

GOAL
main task in the theory of diffraction is to solve this wave equation for different geometries.
we are interested in computing the reflected waves from various types of surfaces

More precisely, we want to compute the wave $\Phi_2$ equal to the reflection of an incoming planar monochromatic wave $\phi_2 = e^{ik k_1 * x}$  traveling in the direction $k_1$ from a surface S.

The equation relating the reflected field to the incoming field is known as the Kirchhoff integral. This equation is a formalization of Huygenâ€™s well-known principle that states that if one knows the wavefront at a given moment, the wave at a later time can be deduced by considering each point on the first wave as the source of a new disturbance, i.e. once the field on the surface is known, the field everywhere else away from the surface can be computed. 

which will result in $\phi_2 = \frac{ik e^{ikR}}{Fv - p}*\int_{S} n * e^{ik v * s} ds$ where x is the observing point, k2 is equal to the unit vector pointing from the origin of the surface towards the point x.

 In this paper we will provide in every case the BRDF corresponding to our reflection model. In the applied optics literature, when dealing with scattered waves from a surface, one does not usually define the BRDF but rather the differential scattering cross-section $\sigma^0 = 4\pi limes R to \infty R^2 \frac{abs(\phi_2)^2}{abs(\phi_1)^2}$

The relationship between the BRDF and the scattering cross section can be shown to be equal to $BRDF = \frac{1}{4 \pi A} * \frac{\sigma^0}{cos(\theta_1)cos(\theta_2)}$


His derivation he shows that 
In this section we demonstrate that the Kirchhoff integral of Equation 2 can be computed analyti- cally.
we restrict ourselves to the reflection of waves from height fields. We assume that the surface is defined as an elevation over the xy-plane using fourier analyis he derives his equation 9 
$BRDF_{\lambda}(w_i, w_r) = \frac{F^2 G}{\lambda^2 A w^2}abs(P(\frac{u}{\lambda},\frac{v}{\lambda}))^2$ 
which is our starting point.

------------------

=> stam paper:
under certain conditions formulate conventional BRDFs for such nanostructures. assumes surface is observed from a large enough distance and then uses the kirchoff integral 

stam formulates for a hightfield auxilary function $p(x,y) = e^{iwkh(x,y)}$ where $w = -(cos(\theta_i)+cos(\theta_r))$ and $\theta_i$ and $\theta_r$ are the angles of incident and reflected directions with the surface normal (ADD picture) and the wavenumber $k=\frac{2\pi}{\lambda}$

$BRDF_{\lambda}(w_i, w_r)$ is BRDF where wavelength $\lambda$ $w_i$ and $w_r$ are incident and reflected normalized directions vectors, pointing away from the given surface. Which can be written, using the fourier transform (FT) $P(u,v) = F(p)(u,v)$, as:
$BRDF_{\lambda}(w_i, w_r) = \frac{F^2 G}{\lambda^2 A w^2}abs(P(\frac{u}{\lambda},\frac{v}{\lambda}))^2$ where F represents the Fresnel term, uv,v,w are derived from the incident and reflected directions as $(u,v,w) = -\omega_i - \omega_r$, abs(P) represents the expected valuess of a random variable X and A is an area of integration on the surface that is considered to contribute to diffraction, G is the geometry term which is $G = \frac{(1+w_r * w_i)^2}{cos(\theta_i)cos(\theta_r)}$


\subsubsection{Stams derivation}

abstract:
before: most reflection models empirically or based on ray-theory of light.
now: new reflection model based on wave theory modeling the effect of diffraction


In his Paper Diffraction Shader, Jos Stam derives a BRDF which modeling the effect of diffraction for various analytical anistropic reflaction models using the scalar Kirchof theory and the theory of random processes. By emplyong the so called wave theory of diffraction [source 5 in stams paper] in which a wave is assumed to be a complex valued scalar. It's noteworthy, that stam's BRDF formulation does not take into account the polarization of the light. Fortunately, light sources like sunlight and light bulbs are unpilarizaed. In our simulations we will always assume we have given i directional light source, i.e. sunlight. Hence, we can use stam's model for our derivations

A further assumption in Stam's Paper is, the emanated waves from the source are stationary - sunlight once again.
Which implies the wave is a superposition of independent monochromatic waves. This implies that each wave is associated to a definite wavelangth lambda.

Mention Helmolth equation, which has the solution $k = \frac{2\pi}{\lambda}$ which is the wavenumber

Stams starts his derviations by above's assumptions and by applying the Kirchhoff integral, which descirbes the reflected field and the Huygen's principle, which states, when somebody knows the wavefront at a given moment, the wave at a later time can be deducted by considering each point on the first wave as the source of a new disturbance.

\begin{equation}
  \psi_2 = \frac{i k e^{i K R}}{4 \pi R}(F\mathbf{v}-\mathbf{p}) \cdot \int_{S} \hat{\mathbf{n}} e^{ik\mathbf{v} \cdot \mathbf{s} d\mathbf{s}}
\end{equation}


In optics, when dealing with scattered waves, one does use differential scattering cross-section rather than a BRDF which has the following identitiy: 

\begin{equation}
    \sigma^0 = 4 \pi \lim_{R \to \infty} R^2 \frac{\langle \left|\psi_2\right|^2\rangle}{\langle \left|\psi_1\right|^2\rangle}
\end{equation}

Relationship between the BRDF and the scattering cross section is the follwing:

\begin{equation}
    BRDF = \frac{1}{4\pi}\frac{1}{A}\frac{\sigma^0}{cos(\theta_1)cos(\theta_2)}
\end{equation}

Wheras $\theta_1a$ and $\theta_2$ are the angles that the vectors $\hat{k_1}$
and $\hat{k_2}$ make with the vertical direction.
 
ADD FIGURE for k1, k2

where R is the disance from the center of the patch to the receiving point $x_p$, $\hat{\mathbf{n}}$ is the normal of the surface at s and the vectors:

\begin{equation*}
    \mathbf{v} = \hat{\mathbf{k_1}} - \hat{\mathbf{k_1}}
               = (u,v,w)
\end{equation*}

\begin{equation*}
    \mathbf{p} = \hat{\mathbf{k_1}} + \hat{\mathbf{k_1}}
\end{equation*}

During his derivations, Stam provides a analytical representation for the Kirchhoff integral by using his assumptions. He restricts himself to the reflaction of waves from height fields $h(x,y)$ with the assumption that the surface is defined as an elevation over the (x,y) plane using the surface plane approximation.
Which will lead him to the follwoing identity for the Kirchhoff integral

\begin{equation}
    \mathbf{I}(ku, kv) = \int \int \frac{1}{ikw}(-p_x, -p_y, ikwp) 
\end{equation}

wheras 

\begin{equation}
    p(x,y) = e^{ikwh(x,y)}
\end{equation}

We the observation that the integral is a Fourier transform by $-iku$ and $-ikv$
which will lead us to his final derivation, using the identity of BRDF, and computing the limes:

\begin{equation}
    BRDF = \frac{k^2 F^2 G}{4\pi^2 A w^2} \langle \left|P(ku, kv)\right|^2\rangle
\end{equation}

Where 

\begin{equation}
    G = \frac{(1-\hat{\mathbf{k_1}}\cdot\hat{\mathbf{k_2}})^2}{cos(\theta_1)cos(\theta_2)}
\end{equation}

and P(x,y) is the Fourier transform of the function p(x,y) from above.

This identitiy for the BRDF is the starting point for our derivations.

\subsection{Previous work}
stam, hooke, see our paper, see stams paper, see own research.


Robert Hooke = observed connection between microscopic structures and colorisation
wave nature of light led to conclusion that the cause for the coloration lies in wave interference.

\subsection{Overview}
outline chapters of thesis and show what is about.













